(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-investigates-mdfInv"],{"017f":function(t,e,i){"use strict";i.r(e);var n=i("4c48"),s=i.n(n);for(var o in n)"default"!==o&&function(t){i.d(e,t,function(){return n[t]})}(o);e["default"]=s.a},"4c48":function(t,e,i){"use strict";var n=i("288e");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=n(i("f499"));i("7f7f");var o={data:function(){return{investigate:{},name:"",questionList:[{stem:"徐英豪是不是沙雕",options:[{option:"A",value:"是"}],type:3}],userInfo:{},showAddQst:!1,showAddOpt:!1,showMdfQst:!1,active:1,addQstStem:"",newOptionVal:"",addQstOptions:[],mdfKey:0,tags:[],activeNames:[],result:[],description:""}},onLoad:function(){var t=this;this.$toast.loading({duration:0,forbidClick:!0,message:"加载中"}),null!=this.$cookies.get("userInfo")&&(this.userInfo=this.$cookies.get("userInfo"));var e=i("9ad7"),n={method:"POST",uri:"http://101.201.70.76:8211/getInvestigate",form:{id:this.$route.query.invId}};e(n).then(function(e){t.investigate=JSON.parse(e)[0],t.name=t.investigate.name,t.description=t.investigate.description,t.questionList=JSON.parse(t.investigate.details),console.log(t.questionList),t.$toast.clear(),t.$toast.success("加载成功")}).catch(function(e){console.log(e),t.$toast.clear(),t.$toast.fail("加载失败，请检查网络连接")})},methods:{addTag:function(){this.showAddQst=!0},createOption:function(){this.showAddOpt=!0,this.newOptionVal=""},confirmOption:function(){var t={option:String.fromCharCode(65+this.addQstOptions.length),value:this.newOptionVal};this.addQstOptions[this.addQstOptions.length]=t,this.newOptionVal="",this.$forceUpdate()},confirmQst:function(t){if(0==t)if(0==this.addQstOptions.length)this.$toast.fail("选项不能为空!");else if(""==this.addQstStem)this.$toast.fail("题干不能为空!");else{var e={stem:this.addQstStem,options:this.addQstOptions,type:0};this.questionList[this.questionList.length]=e,this.addQstStem="",this.addQstOptions=[],this.$forceUpdate()}else if(1==t)if(""==this.addQstStem)this.$toast.fail("题干不能为空!");else{e={stem:this.addQstStem,options:null,type:1};console.log(e),this.questionList[this.questionList.length]=e,this.addQstStem="",this.$forceUpdate()}},deleteQst:function(t){this.questionList.splice(t,1),this.$forceUpdate()},modifyQst:function(t,e){this.mdfKey=t,this.showMdfQst=!0},confirmModify:function(t,e){this.showMdfQst=!1,this.$forceUpdate()},showRes:function(){this.$router.push({path:"/pages/investigates/invResult",query:{invDetailsId:this.investigate.id}})},submit:function(){var t=this;this.$toast.loading({duration:0,forbidClick:!0,message:"提交中"}),this.name==this.investigate.name&&(this.name="null"),this.description==this.investigate.description&&(this.description="null");var e=(0,s.default)(this.questionList);e==this.investigate.details&&(e="null");var n=i("9ad7"),o={method:"POST",uri:"http://101.201.70.76:8211/mdfInvestigate",form:{id:this.investigate.id,description:this.description,name:this.name,invDetails:e}};n(o).then(function(e){"null"==t.name&&(t.name=t.investigate.name),"null"==t.description&&(t.description=t.investigate.description),t.$toast.clear(),t.$toast.success("提交成功，请耐心等待审核")}).catch(function(e){t.$toast.clear(),t.$toast.fail("提交失败，请检查网络连接"),console.log(e)})}}};e.default=o},d7a9:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",[i("van-button",{attrs:{icon:"share",size:"large",type:"primary"},on:{click:function(e){e=t.$handleEvent(e),t.submit()}}},[t._v("提交审核")]),t.investigate.visible?i("van-button",{attrs:{icon:"plus",size:"large",type:"warning"},on:{click:function(e){e=t.$handleEvent(e),t.showRes()}}},[t._v("查看结果")]):t._e(),i("van-button",{attrs:{icon:"plus",size:"large",type:"info"},on:{click:function(e){e=t.$handleEvent(e),t.addTag()}}},[t._v("新增问题")]),i("van-cell-group",[i("van-field",{attrs:{label:"问卷名",placeholder:"请输入问卷名",required:""},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}}),i("van-field",{attrs:{rows:"1",autosize:"",label:"问卷简介",type:"textarea",placeholder:"请输入简介"},model:{value:t.description,callback:function(e){t.description=e},expression:"description"}})],1),t._l(t.questionList,function(e,n){return i("v-uni-view",{key:n},[0==e.type?i("van-panel",{attrs:{title:e.stem,status:"选择题"}},[t._l(e.options,function(t,e){return i("v-uni-view",{key:e},[i("van-field",{attrs:{value:t.value,label:t.option,disabled:""}})],1)}),i("v-uni-view",{attrs:{slot:"footer"},slot:"footer"},[i("van-button",{attrs:{size:"small"},on:{click:function(e){e=t.$handleEvent(e),t.modifyQst(n,0)}}},[t._v("修改")]),i("van-button",{attrs:{size:"small",type:"danger"},on:{click:function(e){e=t.$handleEvent(e),t.deleteQst(n)}}},[t._v("删除")])],1)],2):1==e.type?i("van-panel",{attrs:{title:e.stem,status:"简答题"}},[i("v-uni-view",{attrs:{slot:"footer"},slot:"footer"},[i("van-button",{attrs:{size:"small"},on:{click:function(e){e=t.$handleEvent(e),t.modifyQst(n,1)}}},[t._v("修改")]),i("van-button",{attrs:{size:"small",type:"danger"},on:{click:function(e){e=t.$handleEvent(e),t.deleteQst(n)}}},[t._v("删除")])],1)],1):t._e()],1)}),i("van-popup",{attrs:{position:"bottom"},model:{value:t.showAddQst,callback:function(e){t.showAddQst=e},expression:"showAddQst"}},[i("van-tabs",{attrs:{animated:""},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},[i("van-tab",{attrs:{title:"选择题"}},[i("van-cell-group",[i("van-field",{attrs:{rows:"1",autosize:"",label:"题干",type:"textarea",placeholder:"请输入题干"},model:{value:t.addQstStem,callback:function(e){t.addQstStem=e},expression:"addQstStem"}})],1),t._l(t.addQstOptions,function(t,e){return i("van-cell-group",{key:e},[i("van-cell",{attrs:{title:t.option,value:"选项",label:t.value}})],1)}),i("van-button",{attrs:{type:"primary",size:"large"},on:{click:function(e){e=t.$handleEvent(e),t.createOption()}}},[t._v("新增选项")]),i("van-button",{attrs:{type:"info",size:"large"},on:{click:function(e){e=t.$handleEvent(e),t.confirmQst(0)}}},[t._v("提交")])],2),i("van-tab",{attrs:{title:"简答题"}},[i("van-cell-group",[i("van-field",{attrs:{rows:"1",autosize:"",label:"题干",type:"textarea",placeholder:"请输入题干"},model:{value:t.addQstStem,callback:function(e){t.addQstStem=e},expression:"addQstStem"}})],1),i("van-button",{attrs:{type:"info",size:"large"},on:{click:function(e){e=t.$handleEvent(e),t.confirmQst(1)}}},[t._v("提交")])],1)],1)],1),i("van-popup",{attrs:{position:"top"},model:{value:t.showAddOpt,callback:function(e){t.showAddOpt=e},expression:"showAddOpt"}},[i("van-cell-group",[i("van-field",{attrs:{rows:"1",label:"选项内容",placeholder:"选项内容"},model:{value:t.newOptionVal,callback:function(e){t.newOptionVal=e},expression:"newOptionVal"}}),i("van-button",{attrs:{type:"primary",size:"large"},on:{click:function(e){e=t.$handleEvent(e),t.confirmOption()}}},[t._v("确定")])],1)],1),i("van-popup",{attrs:{position:"top"},model:{value:t.showMdfQst,callback:function(e){t.showMdfQst=e},expression:"showMdfQst"}},[0==t.questionList[t.mdfKey].type?i("van-panel",{attrs:{title:"选择题修改"}},[i("van-field",{model:{value:t.questionList[t.mdfKey].stem,callback:function(e){t.$set(t.questionList[t.mdfKey],"stem",e)},expression:"questionList[mdfKey].stem"}}),t._l(t.questionList[t.mdfKey].options,function(e,n){return i("v-uni-view",{key:n},[i("van-field",{attrs:{label:e.option},model:{value:t.questionList[t.mdfKey].options[n].value,callback:function(e){t.$set(t.questionList[t.mdfKey].options[n],"value",e)},expression:"questionList[mdfKey].options[num].value"}})],1)}),i("v-uni-view",{attrs:{slot:"footer"},slot:"footer"},[i("van-button",{attrs:{size:"small",type:"info"},on:{click:function(e){e=t.$handleEvent(e),t.confirmModify()}}},[t._v("修改")])],1)],2):1==t.questionList[t.mdfKey].type?i("van-panel",{attrs:{title:"简答题修改"}},[i("van-field",{model:{value:t.questionList[t.mdfKey].stem,callback:function(e){t.$set(t.questionList[t.mdfKey],"stem",e)},expression:"questionList[mdfKey].stem"}}),i("v-uni-view",{attrs:{slot:"footer"},slot:"footer"},[i("van-button",{attrs:{size:"small"},on:{click:function(e){e=t.$handleEvent(e),t.confirmModify()}}},[t._v("修改")])],1)],1):t._e()],1)],2)},s=[];i.d(e,"a",function(){return n}),i.d(e,"b",function(){return s})},e83f:function(t,e,i){"use strict";i.r(e);var n=i("d7a9"),s=i("017f");for(var o in s)"default"!==o&&function(t){i.d(e,t,function(){return s[t]})}(o);var a=i("2877"),l=Object(a["a"])(s["default"],n["a"],n["b"],!1,null,"6c68424e",null);e["default"]=l.exports}}]);