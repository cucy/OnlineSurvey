(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-tag-mdfTag"],{"701c":function(t,s,e){"use strict";e.r(s);var a=e("e6c2"),i=e("cdca");for(var n in i)"default"!==n&&function(t){e.d(s,t,function(){return i[t]})}(n);var o=e("2877"),d=Object(o["a"])(i["default"],a["a"],a["b"],!1,null,"48fae57a",null);s["default"]=d.exports},cabe:function(t,s,e){"use strict";var a=e("288e");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var i=a(e("f499"));e("7f7f");var n={data:function(){return{isLoading:!1,tempMdfName:"",tempMdfDescription:"",tmepMdfKey:0,showAddPopup:!1,showMdfPopup:!1,userInfo:{},tags:{del:[],list:[],mdf:[],status:[],add:[]}}},onLoad:function(){var t=this;this.$toast.loading({duration:0,forbidClick:!0,message:"加载中"}),null!=this.$cookies.get("userInfo")&&(this.userInfo=this.$cookies.get("userInfo"));var s=e("9ad7");s("http://101.201.70.76:8211/getTags").then(function(s){t.tags.list=JSON.parse(s);for(var e=0;e<t.tags.list.length;e++)t.tags.del[e]=!1,t.tags.mdf[e]=!1,t.tags.add[e]=!1,t.tags.status[e]="无状态";console.log(t.tags),t.$toast.clear(),t.$toast.success("加载成功")}).catch(function(s){t.$toast.clear(),t.$toast.fail("加载失败，请检查网络连接"),console.log(s)})},methods:{onRefresh:function(){var t=this;setTimeout(function(){t.isLoading=!1,null!=t.$cookies.get("userInfo")&&(t.userInfo=t.$cookies.get("userInfo"));var s=e("9ad7");s("http://101.201.70.76:8211/getTags").then(function(s){t.tags.list=JSON.parse(s);for(var e=0;e<t.tags.list.length;e++)t.tags.del[e]=!1,t.tags.mdf[e]=!1,t.tags.add[e]=!1,t.tags.status[e]="无状态";console.log(t.tags),t.$toast.success("刷新成功")}).catch(function(t){console.log(t)})},500)},addTag:function(){this.tempMdfName="",this.tempMdfDescription="",this.showAddPopup=!0},confirmAddTag:function(){var t=this.tags.list.length,s={name:this.tempMdfName,description:this.tempMdfDescription,id:400000001+t};this.tags.list[t]=s,this.tags.status[t]="新添加",this.tags.mdf[t]=!1,this.tags.del[t]=!1,this.tags.add[t]=!0,this.showAddPopup=!1,this.$forceUpdate()},modifyTag:function(t){console.log(this.tags.list[t]),this.tmepMdfKey=t,this.showMdfPopup=!0,this.tempMdfName=this.tags.list[t].name,this.tempMdfDescription=this.tags.list[t].description},confirmTag:function(){var t=this.tmepMdfKey;this.tags.mdf[t]=!0,this.tags.status[t]="已修改",this.showMdfPopup=!1,this.tags.list[t].name=this.tempMdfName,this.tags.list[t].description=this.tempMdfDescription,console.log(this.tags.list[t]),this.$forceUpdate()},deleteTag:function(t){this.tags.del[t]=!0,this.tags.status[t]="已删除",this.$forceUpdate()},recoverTag:function(t){this.tags.del[t]=!1,this.tags.mdf[t]=!1,this.tags.status[t]="已恢复",this.tags.add[t]&&(this.tags.list.splice(t,1),this.tags.del.splice(t,1),this.tags.add.splice(t,1),this.tags.mdf.splice(t,1),this.tags.status.splice(t,1)),this.$forceUpdate()},submit:function(){var t=this;this.$toast.loading({duration:0,forbidClick:!0,message:"提交中"});for(var s=[],a=[],n=[],o=0,d=0,l=0,c=0;c<this.tags.list.length;c++)if(this.tags.add[c]){var f={id:this.tags.list[c].id,name:this.tags.list[c].name,description:this.tags.list[c].description};s[o++]=f}else if(this.tags.del[c]){var r={id:this.tags.list[c].id,name:this.tags.list[c].name,description:this.tags.list[c].description};a[d++]=r}else if(this.tags.mdf[c]){f={id:this.tags.list[c].id,name:this.tags.list[c].name,description:this.tags.list[c].description};n[l++]=f}var u=e("9ad7"),p={method:"POST",uri:"http://101.201.70.76:8211/updateTags",form:{add:(0,i.default)(s),mdf:(0,i.default)(n),del:(0,i.default)(a)}};u(p).then(function(s){t.$toast.clear(),t.$toast.success("提交成功"),t.onRefresh()}).catch(function(s){t.$toast.clear(),t.$toast.fail("提交失败，请检查网络连接"),console.log(s)})}}};s.default=n},cdca:function(t,s,e){"use strict";e.r(s);var a=e("cabe"),i=e.n(a);for(var n in a)"default"!==n&&function(t){e.d(s,t,function(){return a[t]})}(n);s["default"]=i.a},e6c2:function(t,s,e){"use strict";var a=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("v-uni-view",[e("van-pull-refresh",{on:{refresh:function(s){s=t.$handleEvent(s),t.onRefresh(s)}},model:{value:t.isLoading,callback:function(s){t.isLoading=s},expression:"isLoading"}},[e("van-button",{attrs:{icon:"share",size:"large",type:"primary"},on:{click:function(s){s=t.$handleEvent(s),t.submit()}}},[t._v("提交修改")]),e("van-button",{attrs:{icon:"plus",size:"large",type:"info"},on:{click:function(s){s=t.$handleEvent(s),t.addTag()}}},[t._v("添加标签")]),t._l(t.tags.list,function(s,a){return e("van-panel",{key:a,attrs:{title:s.name,desc:s.description,status:t.tags.status[a]}},[e("v-uni-view",{attrs:{slot:"footer"},slot:"footer"},[e("van-button",{attrs:{size:"small"},on:{click:function(s){s=t.$handleEvent(s),t.modifyTag(a)}}},[t._v("修改")]),e("van-button",{attrs:{size:"small",type:"danger"},on:{click:function(s){s=t.$handleEvent(s),t.deleteTag(a)}}},[t._v("删除")]),t.tags.add[a]||t.tags.mdf[a]||t.tags.del[a]?e("van-button",{attrs:{size:"small"},on:{click:function(s){s=t.$handleEvent(s),t.recoverTag(a)}}},[t._v("恢复")]):t._e()],1)],1)}),e("van-popup",{attrs:{position:"bottom"},model:{value:t.showMdfPopup,callback:function(s){t.showMdfPopup=s},expression:"showMdfPopup"}},[e("van-cell-group",[e("van-field",{attrs:{label:"标签名","left-icon":"coupon-o"},model:{value:t.tempMdfName,callback:function(s){t.tempMdfName=s},expression:"tempMdfName"}}),e("van-field",{attrs:{label:"描述","left-icon":"comment-o"},model:{value:t.tempMdfDescription,callback:function(s){t.tempMdfDescription=s},expression:"tempMdfDescription"}}),e("van-button",{attrs:{size:"large",type:"info"},on:{click:function(s){s=t.$handleEvent(s),t.confirmTag()}}},[t._v("确认")])],1)],1),e("van-popup",{attrs:{position:"bottom"},model:{value:t.showAddPopup,callback:function(s){t.showAddPopup=s},expression:"showAddPopup"}},[e("van-cell-group",[e("van-field",{attrs:{label:"标签名","left-icon":"coupon-o"},model:{value:t.tempMdfName,callback:function(s){t.tempMdfName=s},expression:"tempMdfName"}}),e("van-field",{attrs:{label:"描述","left-icon":"comment-o"},model:{value:t.tempMdfDescription,callback:function(s){t.tempMdfDescription=s},expression:"tempMdfDescription"}}),e("van-button",{attrs:{size:"large",type:"info"},on:{click:function(s){s=t.$handleEvent(s),t.confirmAddTag()}}},[t._v("确认")])],1)],1)],2)],1)},i=[];e.d(s,"a",function(){return a}),e.d(s,"b",function(){return i})}}]);